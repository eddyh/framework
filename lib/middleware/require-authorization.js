"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = requireAuthorization;

var _errors = require("../errors");

/* eslint-disable no-unused-expressions */
function requireAuthorization(realm, credentials) {
  return function requireAuthorization(next) {
    this;

    const { username, password } = this.data;
    if (username && password === credentials[username]) {
      return next();
    } else {
      this.set("WWW-Authenticate", `Basic realm="${realm}"`);
      throw new _errors.Unauthorized();
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3JlcXVpcmUtYXV0aG9yaXphdGlvbi5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlQXV0aG9yaXphdGlvbiIsInJlYWxtIiwiY3JlZGVudGlhbHMiLCJuZXh0IiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImRhdGEiLCJzZXQiXSwibWFwcGluZ3MiOiI7Ozs7O2tCQU13QkEsb0I7O0FBRnhCOztBQUhBO0FBS2UsU0FBU0Esb0JBQVQsQ0FBOEJDLEtBQTlCLEVBQTZDQyxXQUE3QyxFQUFvRztBQUNqSCxTQUFPLFNBQVNGLG9CQUFULENBQThCRyxJQUE5QixFQUEwQztBQUM5QyxRQUFEOztBQUVBLFVBQU0sRUFBQ0MsUUFBRCxFQUFXQyxRQUFYLEtBQXVCLEtBQUtDLElBQWxDO0FBQ0EsUUFBSUYsWUFBWUMsYUFBYUgsWUFBWUUsUUFBWixDQUE3QixFQUFvRDtBQUNsRCxhQUFPRCxNQUFQO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsV0FBS0ksR0FBTCxDQUFTLGtCQUFULEVBQThCLGdCQUFlTixLQUFNLEdBQW5EO0FBQ0EsWUFBTSwwQkFBTjtBQUNEO0FBQ0YsR0FWRDtBQVdEIiwiZmlsZSI6InJlcXVpcmUtYXV0aG9yaXphdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtZXhwcmVzc2lvbnMgKi9cbmltcG9ydCB0eXBlIHtDb250ZXh0LCBOZXh0LCBNaWRkbGV3YXJlfSBmcm9tIFwiLi4vbWlkZGxld2FyZVwiXG5cbmltcG9ydCB7VW5hdXRob3JpemVkfSBmcm9tIFwiLi4vZXJyb3JzXCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVxdWlyZUF1dGhvcml6YXRpb24ocmVhbG06IHN0cmluZywgY3JlZGVudGlhbHM6IHtbdXNlcm5hbWU6IHN0cmluZ106IHN0cmluZ30pOiBNaWRkbGV3YXJlIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcXVpcmVBdXRob3JpemF0aW9uKG5leHQ6IE5leHQpIHtcbiAgICAodGhpczogQ29udGV4dClcblxuICAgIGNvbnN0IHt1c2VybmFtZSwgcGFzc3dvcmR9ID0gdGhpcy5kYXRhXG4gICAgaWYgKHVzZXJuYW1lICYmIHBhc3N3b3JkID09PSBjcmVkZW50aWFsc1t1c2VybmFtZV0pIHtcbiAgICAgIHJldHVybiBuZXh0KClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXQoXCJXV1ctQXV0aGVudGljYXRlXCIsIGBCYXNpYyByZWFsbT1cIiR7cmVhbG19XCJgKVxuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZFxuICAgIH1cbiAgfVxufVxuIl19