"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = parseAuthorization;
function parseAuthorization() {
  return function parseAuthorization(next) {
    const ctx = this;

    const auth = this.req.headers.authorization;

    if (auth) {
      const [type, credentials] = auth.split(/\s+/);

      if (type.toLowerCase() === "basic") {
        const [username, password] = new Buffer(credentials, "base64").toString().split(":");
        ctx.data.username = username || "";
        ctx.data.password = password || "";
      }
    }

    return next();
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3BhcnNlLWF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsicGFyc2VBdXRob3JpemF0aW9uIiwibmV4dCIsImN0eCIsImF1dGgiLCJyZXEiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInR5cGUiLCJjcmVkZW50aWFscyIsInNwbGl0IiwidG9Mb3dlckNhc2UiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiQnVmZmVyIiwidG9TdHJpbmciLCJkYXRhIl0sIm1hcHBpbmdzIjoiOzs7OztrQkFHd0JBLGtCO0FBQVQsU0FBU0Esa0JBQVQsR0FBMEM7QUFDdkQsU0FBTyxTQUFTQSxrQkFBVCxDQUE0QkMsSUFBNUIsRUFBd0M7QUFDN0MsVUFBTUMsTUFBZSxJQUFyQjs7QUFFQSxVQUFNQyxPQUFPLEtBQUtDLEdBQUwsQ0FBU0MsT0FBVCxDQUFpQkMsYUFBOUI7O0FBRUEsUUFBSUgsSUFBSixFQUFVO0FBQ1IsWUFBTSxDQUFDSSxJQUFELEVBQU9DLFdBQVAsSUFBc0JMLEtBQUtNLEtBQUwsQ0FBVyxLQUFYLENBQTVCOztBQUVBLFVBQUlGLEtBQUtHLFdBQUwsT0FBdUIsT0FBM0IsRUFBb0M7QUFDbEMsY0FBTSxDQUFDQyxRQUFELEVBQVdDLFFBQVgsSUFBdUIsSUFBSUMsTUFBSixDQUFXTCxXQUFYLEVBQXdCLFFBQXhCLEVBQWtDTSxRQUFsQyxHQUE2Q0wsS0FBN0MsQ0FBbUQsR0FBbkQsQ0FBN0I7QUFDQVAsWUFBSWEsSUFBSixDQUFTSixRQUFULEdBQW9CQSxZQUFZLEVBQWhDO0FBQ0FULFlBQUlhLElBQUosQ0FBU0gsUUFBVCxHQUFvQkEsWUFBWSxFQUFoQztBQUNEO0FBQ0Y7O0FBRUQsV0FBT1gsTUFBUDtBQUNELEdBaEJEO0FBaUJEIiwiZmlsZSI6InBhcnNlLWF1dGhvcml6YXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuaW1wb3J0IHR5cGUge0NvbnRleHQsIE5leHQsIE1pZGRsZXdhcmV9IGZyb20gXCIuLi9taWRkbGV3YXJlXCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uKCk6IE1pZGRsZXdhcmUge1xuICByZXR1cm4gZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uKG5leHQ6IE5leHQpIHtcbiAgICBjb25zdCBjdHg6IENvbnRleHQgPSB0aGlzXG5cbiAgICBjb25zdCBhdXRoID0gdGhpcy5yZXEuaGVhZGVycy5hdXRob3JpemF0aW9uXG5cbiAgICBpZiAoYXV0aCkge1xuICAgICAgY29uc3QgW3R5cGUsIGNyZWRlbnRpYWxzXSA9IGF1dGguc3BsaXQoL1xccysvKVxuXG4gICAgICBpZiAodHlwZS50b0xvd2VyQ2FzZSgpID09PSBcImJhc2ljXCIpIHtcbiAgICAgICAgY29uc3QgW3VzZXJuYW1lLCBwYXNzd29yZF0gPSBuZXcgQnVmZmVyKGNyZWRlbnRpYWxzLCBcImJhc2U2NFwiKS50b1N0cmluZygpLnNwbGl0KFwiOlwiKVxuICAgICAgICBjdHguZGF0YS51c2VybmFtZSA9IHVzZXJuYW1lIHx8IFwiXCJcbiAgICAgICAgY3R4LmRhdGEucGFzc3dvcmQgPSBwYXNzd29yZCB8fCBcIlwiXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG5leHQoKVxuICB9XG59XG4iXX0=