"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = parseAuthorization;
function parseAuthorization() {
  return function parseAuthorization(next) {
    const ctx = this;

    const auth = this.req.headers.authorization;

    if (auth) {
      const [type, credentials] = auth.split(/\s+/);

      if (type.toLowerCase() === "basic" && credentials) {
        const [username, password] = Buffer.from(credentials, "base64").toString().split(":");
        ctx.data.username = username || "";
        ctx.data.password = password || "";
      }
    }

    return next();
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3BhcnNlLWF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsicGFyc2VBdXRob3JpemF0aW9uIiwibmV4dCIsImN0eCIsImF1dGgiLCJyZXEiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInR5cGUiLCJjcmVkZW50aWFscyIsInNwbGl0IiwidG9Mb3dlckNhc2UiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7Ozs7a0JBR3dCQSxrQjtBQUFULFNBQVNBLGtCQUFULEdBQTBDO0FBQ3ZELFNBQU8sU0FBU0Esa0JBQVQsQ0FBNEJDLElBQTVCLEVBQXdDO0FBQzdDLFVBQU1DLE1BQWUsSUFBckI7O0FBRUEsVUFBTUMsT0FBTyxLQUFLQyxHQUFMLENBQVNDLE9BQVQsQ0FBaUJDLGFBQTlCOztBQUVBLFFBQUlILElBQUosRUFBVTtBQUNSLFlBQU0sQ0FBQ0ksSUFBRCxFQUFPQyxXQUFQLElBQXNCTCxLQUFLTSxLQUFMLENBQVcsS0FBWCxDQUE1Qjs7QUFFQSxVQUFJRixLQUFLRyxXQUFMLE9BQXVCLE9BQXZCLElBQWtDRixXQUF0QyxFQUFtRDtBQUNqRCxjQUFNLENBQUNHLFFBQUQsRUFBV0MsUUFBWCxJQUF1QkMsT0FBT0MsSUFBUCxDQUFZTixXQUFaLEVBQXlCLFFBQXpCLEVBQW1DTyxRQUFuQyxHQUE4Q04sS0FBOUMsQ0FBb0QsR0FBcEQsQ0FBN0I7QUFDQVAsWUFBSWMsSUFBSixDQUFTTCxRQUFULEdBQW9CQSxZQUFZLEVBQWhDO0FBQ0FULFlBQUljLElBQUosQ0FBU0osUUFBVCxHQUFvQkEsWUFBWSxFQUFoQztBQUNEO0FBQ0Y7O0FBRUQsV0FBT1gsTUFBUDtBQUNELEdBaEJEO0FBaUJEIiwiZmlsZSI6InBhcnNlLWF1dGhvcml6YXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuaW1wb3J0IHR5cGUge0NvbnRleHQsIE5leHQsIE1pZGRsZXdhcmV9IGZyb20gXCIuLi9taWRkbGV3YXJlXCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uKCk6IE1pZGRsZXdhcmUge1xuICByZXR1cm4gZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uKG5leHQ6IE5leHQpIHtcbiAgICBjb25zdCBjdHg6IENvbnRleHQgPSB0aGlzXG5cbiAgICBjb25zdCBhdXRoID0gdGhpcy5yZXEuaGVhZGVycy5hdXRob3JpemF0aW9uXG5cbiAgICBpZiAoYXV0aCkge1xuICAgICAgY29uc3QgW3R5cGUsIGNyZWRlbnRpYWxzXSA9IGF1dGguc3BsaXQoL1xccysvKVxuXG4gICAgICBpZiAodHlwZS50b0xvd2VyQ2FzZSgpID09PSBcImJhc2ljXCIgJiYgY3JlZGVudGlhbHMpIHtcbiAgICAgICAgY29uc3QgW3VzZXJuYW1lLCBwYXNzd29yZF0gPSBCdWZmZXIuZnJvbShjcmVkZW50aWFscywgXCJiYXNlNjRcIikudG9TdHJpbmcoKS5zcGxpdChcIjpcIilcbiAgICAgICAgY3R4LmRhdGEudXNlcm5hbWUgPSB1c2VybmFtZSB8fCBcIlwiXG4gICAgICAgIGN0eC5kYXRhLnBhc3N3b3JkID0gcGFzc3dvcmQgfHwgXCJcIlxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXh0KClcbiAgfVxufVxuIl19