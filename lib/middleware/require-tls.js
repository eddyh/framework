"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = requireTLS;

var _errors = require("../errors");

/* eslint-disable no-unused-expressions */
function requireTLS() {
  return function requireTLS(next) {
    this;

    const socket = this.request.socket;

    if (socket.encrypted) return next();
    if (this.get("x-forwarded-proto") === "https") return next();
    if (process.env.NODE_ENV === "development") return next();

    throw new _errors.Forbidden("TLS required");
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3JlcXVpcmUtdGxzLmpzIl0sIm5hbWVzIjpbInJlcXVpcmVUTFMiLCJuZXh0Iiwic29ja2V0IiwicmVxdWVzdCIsImVuY3J5cHRlZCIsImdldCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsIkZvcmJpZGRlbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7a0JBTXdCQSxVOztBQUZ4Qjs7QUFIQTtBQUtlLFNBQVNBLFVBQVQsR0FBa0M7QUFDL0MsU0FBTyxTQUFTQSxVQUFULENBQW9CQyxJQUFwQixFQUFnQztBQUNwQyxRQUFEOztBQUVBLFVBQU1DLFNBQXFDLEtBQUtDLE9BQUwsQ0FBYUQsTUFBeEQ7O0FBRUEsUUFBSUEsT0FBT0UsU0FBWCxFQUFzQixPQUFPSCxNQUFQO0FBQ3RCLFFBQUksS0FBS0ksR0FBTCxDQUFTLG1CQUFULE1BQWtDLE9BQXRDLEVBQStDLE9BQU9KLE1BQVA7QUFDL0MsUUFBSUssUUFBUUMsR0FBUixDQUFZQyxRQUFaLEtBQXlCLGFBQTdCLEVBQTRDLE9BQU9QLE1BQVA7O0FBRTVDLFVBQU0sSUFBSVEsaUJBQUosQ0FBYyxjQUFkLENBQU47QUFDRCxHQVZEO0FBV0QiLCJmaWxlIjoicmVxdWlyZS10bHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5pbXBvcnQgdHlwZSB7Q29udGV4dCwgTmV4dCwgTWlkZGxld2FyZX0gZnJvbSBcIi4uL21pZGRsZXdhcmVcIlxuXG5pbXBvcnQge0ZvcmJpZGRlbn0gZnJvbSBcIi4uL2Vycm9yc1wiXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlcXVpcmVUTFMoKTogTWlkZGxld2FyZSB7XG4gIHJldHVybiBmdW5jdGlvbiByZXF1aXJlVExTKG5leHQ6IE5leHQpIHtcbiAgICAodGhpczogQ29udGV4dClcblxuICAgIGNvbnN0IHNvY2tldDogdGxzJFRMU1NvY2tldCB8IG5ldCRTb2NrZXQgPSB0aGlzLnJlcXVlc3Quc29ja2V0XG5cbiAgICBpZiAoc29ja2V0LmVuY3J5cHRlZCkgcmV0dXJuIG5leHQoKVxuICAgIGlmICh0aGlzLmdldChcIngtZm9yd2FyZGVkLXByb3RvXCIpID09PSBcImh0dHBzXCIpIHJldHVybiBuZXh0KClcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIikgcmV0dXJuIG5leHQoKVxuXG4gICAgdGhyb3cgbmV3IEZvcmJpZGRlbihcIlRMUyByZXF1aXJlZFwiKVxuICB9XG59XG4iXX0=