"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = allowCors;

/* eslint-disable no-unused-expressions */

function allowCors(options = {}) {
  if (!options.methods) options.methods = ["GET", "POST", "OPTIONS", "PUT", "PATCH", "DELETE"];

  const origin = Array.isArray(options.origin) ? options.origin.join(", ") : options.origin;

  const methods = Array.isArray(options.methods) ? options.methods.join(", ") : options.methods;

  const requestHeaders = Array.isArray(options.requestHeaders) ? options.requestHeaders.join(", ") : options.requestHeaders;

  const responseHeaders = Array.isArray(options.responseHeaders) ? options.responseHeaders.join(", ") : options.responseHeaders;

  const { maxAge } = options;

  return function cors(next) {
    this;

    if (origin) {
      this.set("Access-Control-Allow-Origin", origin);
      if (methods) this.set("Access-Control-Allow-Methods", methods);
      if (requestHeaders) this.set("Access-Control-Allow-Headers", requestHeaders);
      if (responseHeaders) this.set("Access-Control-Expose-Headers", responseHeaders);
      if (maxAge) this.set("Access-Control-Max-Age", maxAge);
    }

    return next();
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL2FsbG93LWNvcnMuanMiXSwibmFtZXMiOlsiYWxsb3dDb3JzIiwib3B0aW9ucyIsIm1ldGhvZHMiLCJvcmlnaW4iLCJBcnJheSIsImlzQXJyYXkiLCJqb2luIiwicmVxdWVzdEhlYWRlcnMiLCJyZXNwb25zZUhlYWRlcnMiLCJtYXhBZ2UiLCJjb3JzIiwibmV4dCIsInNldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7a0JBYXdCQSxTOztBQVp4Qjs7QUFZZSxTQUFTQSxTQUFULENBQW1CQyxVQUE0QixFQUEvQyxFQUErRDtBQUM1RSxNQUFJLENBQUNBLFFBQVFDLE9BQWIsRUFBc0JELFFBQVFDLE9BQVIsR0FBa0IsQ0FBQyxLQUFELEVBQVEsTUFBUixFQUFnQixTQUFoQixFQUEyQixLQUEzQixFQUFrQyxPQUFsQyxFQUEyQyxRQUEzQyxDQUFsQjs7QUFFdEIsUUFBTUMsU0FBU0MsTUFBTUMsT0FBTixDQUFjSixRQUFRRSxNQUF0QixJQUNiRixRQUFRRSxNQUFSLENBQWVHLElBQWYsQ0FBb0IsSUFBcEIsQ0FEYSxHQUNlTCxRQUFRRSxNQUR0Qzs7QUFHQSxRQUFNRCxVQUFVRSxNQUFNQyxPQUFOLENBQWNKLFFBQVFDLE9BQXRCLElBQ2RELFFBQVFDLE9BQVIsQ0FBZ0JJLElBQWhCLENBQXFCLElBQXJCLENBRGMsR0FDZUwsUUFBUUMsT0FEdkM7O0FBR0EsUUFBTUssaUJBQWlCSCxNQUFNQyxPQUFOLENBQWNKLFFBQVFNLGNBQXRCLElBQ3JCTixRQUFRTSxjQUFSLENBQXVCRCxJQUF2QixDQUE0QixJQUE1QixDQURxQixHQUNlTCxRQUFRTSxjQUQ5Qzs7QUFHQSxRQUFNQyxrQkFBa0JKLE1BQU1DLE9BQU4sQ0FBY0osUUFBUU8sZUFBdEIsSUFDdEJQLFFBQVFPLGVBQVIsQ0FBd0JGLElBQXhCLENBQTZCLElBQTdCLENBRHNCLEdBQ2VMLFFBQVFPLGVBRC9DOztBQUdBLFFBQU0sRUFBQ0MsTUFBRCxLQUFXUixPQUFqQjs7QUFFQSxTQUFPLFNBQVNTLElBQVQsQ0FBY0MsSUFBZCxFQUEwQjtBQUM5QixRQUFEOztBQUVBLFFBQUlSLE1BQUosRUFBWTtBQUNWLFdBQUtTLEdBQUwsQ0FBUyw2QkFBVCxFQUF3Q1QsTUFBeEM7QUFDQSxVQUFJRCxPQUFKLEVBQWEsS0FBS1UsR0FBTCxDQUFTLDhCQUFULEVBQXlDVixPQUF6QztBQUNiLFVBQUlLLGNBQUosRUFBb0IsS0FBS0ssR0FBTCxDQUFTLDhCQUFULEVBQXlDTCxjQUF6QztBQUNwQixVQUFJQyxlQUFKLEVBQXFCLEtBQUtJLEdBQUwsQ0FBUywrQkFBVCxFQUEwQ0osZUFBMUM7QUFDckIsVUFBSUMsTUFBSixFQUFZLEtBQUtHLEdBQUwsQ0FBUyx3QkFBVCxFQUFtQ0gsTUFBbkM7QUFDYjs7QUFFRCxXQUFPRSxNQUFQO0FBQ0QsR0FaRDtBQWFEIiwiZmlsZSI6ImFsbG93LWNvcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5cbmltcG9ydCB0eXBlIHtDb250ZXh0LCBOZXh0LCBNaWRkbGV3YXJlfSBmcm9tIFwiLi4vbWlkZGxld2FyZVwiXG5cbnR5cGUgQWxsb3dDb3JzT3B0aW9ucyA9IHtcbiAgb3JpZ2luPzogc3RyaW5nIHwgQXJyYXk8c3RyaW5nPixcbiAgbWV0aG9kcz86IEFycmF5PHN0cmluZz4sXG4gIHJlcXVlc3RIZWFkZXJzPzogQXJyYXk8c3RyaW5nPixcbiAgcmVzcG9uc2VIZWFkZXJzPzogQXJyYXk8c3RyaW5nPixcbiAgbWF4QWdlPzogbnVtYmVyLFxufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhbGxvd0NvcnMob3B0aW9uczogQWxsb3dDb3JzT3B0aW9ucyA9IHt9KTogTWlkZGxld2FyZSB7XG4gIGlmICghb3B0aW9ucy5tZXRob2RzKSBvcHRpb25zLm1ldGhvZHMgPSBbXCJHRVRcIiwgXCJQT1NUXCIsIFwiT1BUSU9OU1wiLCBcIlBVVFwiLCBcIlBBVENIXCIsIFwiREVMRVRFXCJdXG5cbiAgY29uc3Qgb3JpZ2luID0gQXJyYXkuaXNBcnJheShvcHRpb25zLm9yaWdpbikgP1xuICAgIG9wdGlvbnMub3JpZ2luLmpvaW4oXCIsIFwiKSA6IG9wdGlvbnMub3JpZ2luXG5cbiAgY29uc3QgbWV0aG9kcyA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5tZXRob2RzKSA/XG4gICAgb3B0aW9ucy5tZXRob2RzLmpvaW4oXCIsIFwiKSA6IG9wdGlvbnMubWV0aG9kc1xuXG4gIGNvbnN0IHJlcXVlc3RIZWFkZXJzID0gQXJyYXkuaXNBcnJheShvcHRpb25zLnJlcXVlc3RIZWFkZXJzKSA/XG4gICAgb3B0aW9ucy5yZXF1ZXN0SGVhZGVycy5qb2luKFwiLCBcIikgOiBvcHRpb25zLnJlcXVlc3RIZWFkZXJzXG5cbiAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gQXJyYXkuaXNBcnJheShvcHRpb25zLnJlc3BvbnNlSGVhZGVycykgP1xuICAgIG9wdGlvbnMucmVzcG9uc2VIZWFkZXJzLmpvaW4oXCIsIFwiKSA6IG9wdGlvbnMucmVzcG9uc2VIZWFkZXJzXG5cbiAgY29uc3Qge21heEFnZX0gPSBvcHRpb25zXG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGNvcnMobmV4dDogTmV4dCkge1xuICAgICh0aGlzOiBDb250ZXh0KVxuXG4gICAgaWYgKG9yaWdpbikge1xuICAgICAgdGhpcy5zZXQoXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cIiwgb3JpZ2luKVxuICAgICAgaWYgKG1ldGhvZHMpIHRoaXMuc2V0KFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kc1wiLCBtZXRob2RzKVxuICAgICAgaWYgKHJlcXVlc3RIZWFkZXJzKSB0aGlzLnNldChcIkFjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnNcIiwgcmVxdWVzdEhlYWRlcnMpXG4gICAgICBpZiAocmVzcG9uc2VIZWFkZXJzKSB0aGlzLnNldChcIkFjY2Vzcy1Db250cm9sLUV4cG9zZS1IZWFkZXJzXCIsIHJlc3BvbnNlSGVhZGVycylcbiAgICAgIGlmIChtYXhBZ2UpIHRoaXMuc2V0KFwiQWNjZXNzLUNvbnRyb2wtTWF4LUFnZVwiLCBtYXhBZ2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIG5leHQoKVxuICB9XG59XG4iXX0=