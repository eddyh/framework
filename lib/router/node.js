"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
let Node = class Node {

  constructor(name = "", pattern) {
    this.children = new Map();
    this.patterns = new Map();
    this.handler = null;
    this.leaf = false;

    this.name = name;
    this.pattern = pattern;

    Object.seal(this);
  }

  clone() {
    return new Node(this.name, this.pattern);
  }

  find(part) {
    const node = this.children.get(part);
    if (node) return node;

    for (const node of this.patterns.values()) {
      if (node.pattern && node.pattern.test(part)) return node;
    }
  }

  insert(node) {
    const { key } = node;
    const collection = node.pattern ? this.patterns : this.children;

    const orig = collection.get(key);
    if (orig) return orig;

    collection.set(key, node);
    return node;
  }

  get key() {
    return this.pattern ? this.pattern.source : this.name;
  }

  toString() {
    return this.pattern ? `{${this.name}}` : this.name;
  }
};
exports.default = Node;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yb3V0ZXIvbm9kZS5qcyJdLCJuYW1lcyI6WyJOb2RlIiwiY29uc3RydWN0b3IiLCJuYW1lIiwicGF0dGVybiIsImNoaWxkcmVuIiwiTWFwIiwicGF0dGVybnMiLCJoYW5kbGVyIiwibGVhZiIsIk9iamVjdCIsInNlYWwiLCJjbG9uZSIsImZpbmQiLCJwYXJ0Iiwibm9kZSIsImdldCIsInZhbHVlcyIsInRlc3QiLCJpbnNlcnQiLCJrZXkiLCJjb2xsZWN0aW9uIiwib3JpZyIsInNldCIsInNvdXJjZSIsInRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7OztJQUNxQkEsSSxHQUFOLE1BQU1BLElBQU4sQ0FBVzs7QUFVeEJDLGNBQVlDLE9BQWUsRUFBM0IsRUFBK0JDLE9BQS9CLEVBQWlEO0FBQUEsU0FOakRDLFFBTWlELEdBTm5CLElBQUlDLEdBQUosRUFNbUI7QUFBQSxTQUxqREMsUUFLaUQsR0FMbkIsSUFBSUQsR0FBSixFQUttQjtBQUFBLFNBSGpERSxPQUdpRCxHQUg5QixJQUc4QjtBQUFBLFNBRmpEQyxJQUVpRCxHQUZqQyxLQUVpQzs7QUFDL0MsU0FBS04sSUFBTCxHQUFZQSxJQUFaO0FBQ0EsU0FBS0MsT0FBTCxHQUFlQSxPQUFmOztBQUVBTSxXQUFPQyxJQUFQLENBQVksSUFBWjtBQUNEOztBQUVEQyxVQUFjO0FBQ1osV0FBTyxJQUFJWCxJQUFKLENBQVMsS0FBS0UsSUFBZCxFQUFvQixLQUFLQyxPQUF6QixDQUFQO0FBQ0Q7O0FBRURTLE9BQUtDLElBQUwsRUFBMEI7QUFDeEIsVUFBTUMsT0FBTyxLQUFLVixRQUFMLENBQWNXLEdBQWQsQ0FBa0JGLElBQWxCLENBQWI7QUFDQSxRQUFJQyxJQUFKLEVBQVUsT0FBT0EsSUFBUDs7QUFFVixTQUFLLE1BQU1BLElBQVgsSUFBbUIsS0FBS1IsUUFBTCxDQUFjVSxNQUFkLEVBQW5CLEVBQTJDO0FBQ3pDLFVBQUlGLEtBQUtYLE9BQUwsSUFBZ0JXLEtBQUtYLE9BQUwsQ0FBYWMsSUFBYixDQUFrQkosSUFBbEIsQ0FBcEIsRUFBNkMsT0FBT0MsSUFBUDtBQUM5QztBQUNGOztBQUVESSxTQUFPSixJQUFQLEVBQXlCO0FBQ3ZCLFVBQU0sRUFBQ0ssR0FBRCxLQUFRTCxJQUFkO0FBQ0EsVUFBTU0sYUFBYU4sS0FBS1gsT0FBTCxHQUFlLEtBQUtHLFFBQXBCLEdBQStCLEtBQUtGLFFBQXZEOztBQUVBLFVBQU1pQixPQUFPRCxXQUFXTCxHQUFYLENBQWVJLEdBQWYsQ0FBYjtBQUNBLFFBQUlFLElBQUosRUFBVSxPQUFPQSxJQUFQOztBQUVWRCxlQUFXRSxHQUFYLENBQWVILEdBQWYsRUFBb0JMLElBQXBCO0FBQ0EsV0FBT0EsSUFBUDtBQUNEOztBQUVELE1BQUlLLEdBQUosR0FBa0I7QUFDaEIsV0FBTyxLQUFLaEIsT0FBTCxHQUFlLEtBQUtBLE9BQUwsQ0FBYW9CLE1BQTVCLEdBQXFDLEtBQUtyQixJQUFqRDtBQUNEOztBQUVEc0IsYUFBbUI7QUFDakIsV0FBTyxLQUFLckIsT0FBTCxHQUFnQixJQUFHLEtBQUtELElBQUssR0FBN0IsR0FBa0MsS0FBS0EsSUFBOUM7QUFDRDtBQS9DdUIsQztrQkFBTEYsSSIsImZpbGUiOiJub2RlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5vZGUge1xuICBuYW1lOiBzdHJpbmdcbiAgcGF0dGVybjogP1JlZ0V4cFxuXG4gIGNoaWxkcmVuOiBNYXA8c3RyaW5nLCBOb2RlPiA9IG5ldyBNYXBcbiAgcGF0dGVybnM6IE1hcDxzdHJpbmcsIE5vZGU+ID0gbmV3IE1hcFxuXG4gIGhhbmRsZXI6ID9PYmplY3QgPSBudWxsXG4gIGxlYWY6IGJvb2xlYW4gPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZyA9IFwiXCIsIHBhdHRlcm46ID9SZWdFeHApIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdGhpcy5wYXR0ZXJuID0gcGF0dGVyblxuXG4gICAgT2JqZWN0LnNlYWwodGhpcylcbiAgfVxuXG4gIGNsb25lKCk6IE5vZGUge1xuICAgIHJldHVybiBuZXcgTm9kZSh0aGlzLm5hbWUsIHRoaXMucGF0dGVybilcbiAgfVxuXG4gIGZpbmQocGFydDogc3RyaW5nKTogP05vZGUge1xuICAgIGNvbnN0IG5vZGUgPSB0aGlzLmNoaWxkcmVuLmdldChwYXJ0KVxuICAgIGlmIChub2RlKSByZXR1cm4gbm9kZVxuXG4gICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMucGF0dGVybnMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChub2RlLnBhdHRlcm4gJiYgbm9kZS5wYXR0ZXJuLnRlc3QocGFydCkpIHJldHVybiBub2RlXG4gICAgfVxuICB9XG5cbiAgaW5zZXJ0KG5vZGU6IE5vZGUpOiBOb2RlIHtcbiAgICBjb25zdCB7a2V5fSA9IG5vZGVcbiAgICBjb25zdCBjb2xsZWN0aW9uID0gbm9kZS5wYXR0ZXJuID8gdGhpcy5wYXR0ZXJucyA6IHRoaXMuY2hpbGRyZW5cblxuICAgIGNvbnN0IG9yaWcgPSBjb2xsZWN0aW9uLmdldChrZXkpXG4gICAgaWYgKG9yaWcpIHJldHVybiBvcmlnXG5cbiAgICBjb2xsZWN0aW9uLnNldChrZXksIG5vZGUpXG4gICAgcmV0dXJuIG5vZGVcbiAgfVxuXG4gIGdldCBrZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5wYXR0ZXJuID8gdGhpcy5wYXR0ZXJuLnNvdXJjZSA6IHRoaXMubmFtZVxuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5wYXR0ZXJuID8gYHske3RoaXMubmFtZX19YCA6IHRoaXMubmFtZVxuICB9XG59XG4iXX0=