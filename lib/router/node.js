"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
let Node = class Node {

  constructor(name = "", pattern) {
    this.children = new Map();
    this.patterns = new Map();
    this.handler = null;
    this.leaf = false;

    this.name = name;
    this.pattern = pattern;

    Object.seal(this);
  }

  clone() {
    return new Node(this.name, this.pattern);
  }

  find(part) {
    const node = this.children.get(part);
    if (node) return node;

    for (const node of this.patterns.values()) {
      if (node.pattern && node.pattern.test(part)) return node;
    }
  }

  insert(node) {
    const key = node.toString();
    const collection = node.pattern ? this.patterns : this.children;

    const orig = collection.get(key);
    if (orig) return orig;

    collection.set(key, node);
    return node;
  }

  toString() {
    if (this.pattern) {
      return `{${this.name}}`;
    } else {
      return this.name;
    }
  }
};
exports.default = Node;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yb3V0ZXIvbm9kZS5qcyJdLCJuYW1lcyI6WyJOb2RlIiwiY29uc3RydWN0b3IiLCJuYW1lIiwicGF0dGVybiIsImNoaWxkcmVuIiwiTWFwIiwicGF0dGVybnMiLCJoYW5kbGVyIiwibGVhZiIsIk9iamVjdCIsInNlYWwiLCJjbG9uZSIsImZpbmQiLCJwYXJ0Iiwibm9kZSIsImdldCIsInZhbHVlcyIsInRlc3QiLCJpbnNlcnQiLCJrZXkiLCJ0b1N0cmluZyIsImNvbGxlY3Rpb24iLCJvcmlnIiwic2V0Il0sIm1hcHBpbmdzIjoiOzs7OztJQUNxQkEsSSxHQUFOLE1BQU1BLElBQU4sQ0FBVzs7QUFVeEJDLGNBQVlDLE9BQWUsRUFBM0IsRUFBK0JDLE9BQS9CLEVBQWlEO0FBQUEsU0FOakRDLFFBTWlELEdBTm5CLElBQUlDLEdBQUosRUFNbUI7QUFBQSxTQUxqREMsUUFLaUQsR0FMbkIsSUFBSUQsR0FBSixFQUttQjtBQUFBLFNBSGpERSxPQUdpRCxHQUg5QixJQUc4QjtBQUFBLFNBRmpEQyxJQUVpRCxHQUZqQyxLQUVpQzs7QUFDL0MsU0FBS04sSUFBTCxHQUFZQSxJQUFaO0FBQ0EsU0FBS0MsT0FBTCxHQUFlQSxPQUFmOztBQUVBTSxXQUFPQyxJQUFQLENBQVksSUFBWjtBQUNEOztBQUVEQyxVQUFjO0FBQ1osV0FBTyxJQUFJWCxJQUFKLENBQVMsS0FBS0UsSUFBZCxFQUFvQixLQUFLQyxPQUF6QixDQUFQO0FBQ0Q7O0FBRURTLE9BQUtDLElBQUwsRUFBMEI7QUFDeEIsVUFBTUMsT0FBTyxLQUFLVixRQUFMLENBQWNXLEdBQWQsQ0FBa0JGLElBQWxCLENBQWI7QUFDQSxRQUFJQyxJQUFKLEVBQVUsT0FBT0EsSUFBUDs7QUFFVixTQUFLLE1BQU1BLElBQVgsSUFBbUIsS0FBS1IsUUFBTCxDQUFjVSxNQUFkLEVBQW5CLEVBQTJDO0FBQ3pDLFVBQUlGLEtBQUtYLE9BQUwsSUFBZ0JXLEtBQUtYLE9BQUwsQ0FBYWMsSUFBYixDQUFrQkosSUFBbEIsQ0FBcEIsRUFBNkMsT0FBT0MsSUFBUDtBQUM5QztBQUNGOztBQUVESSxTQUFPSixJQUFQLEVBQXlCO0FBQ3ZCLFVBQU1LLE1BQU1MLEtBQUtNLFFBQUwsRUFBWjtBQUNBLFVBQU1DLGFBQWFQLEtBQUtYLE9BQUwsR0FBZSxLQUFLRyxRQUFwQixHQUErQixLQUFLRixRQUF2RDs7QUFFQSxVQUFNa0IsT0FBT0QsV0FBV04sR0FBWCxDQUFlSSxHQUFmLENBQWI7QUFDQSxRQUFJRyxJQUFKLEVBQVUsT0FBT0EsSUFBUDs7QUFFVkQsZUFBV0UsR0FBWCxDQUFlSixHQUFmLEVBQW9CTCxJQUFwQjtBQUNBLFdBQU9BLElBQVA7QUFDRDs7QUFFRE0sYUFBbUI7QUFDakIsUUFBSSxLQUFLakIsT0FBVCxFQUFrQjtBQUNoQixhQUFRLElBQUcsS0FBS0QsSUFBSyxHQUFyQjtBQUNELEtBRkQsTUFFTztBQUNMLGFBQU8sS0FBS0EsSUFBWjtBQUNEO0FBQ0Y7QUEvQ3VCLEM7a0JBQUxGLEkiLCJmaWxlIjoibm9kZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb2RlIHtcbiAgbmFtZTogc3RyaW5nXG4gIHBhdHRlcm46ID9SZWdFeHBcblxuICBjaGlsZHJlbjogTWFwPHN0cmluZywgTm9kZT4gPSBuZXcgTWFwXG4gIHBhdHRlcm5zOiBNYXA8c3RyaW5nLCBOb2RlPiA9IG5ldyBNYXBcblxuICBoYW5kbGVyOiA/T2JqZWN0ID0gbnVsbFxuICBsZWFmOiBib29sZWFuID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcgPSBcIlwiLCBwYXR0ZXJuOiA/UmVnRXhwKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICAgIHRoaXMucGF0dGVybiA9IHBhdHRlcm5cblxuICAgIE9iamVjdC5zZWFsKHRoaXMpXG4gIH1cblxuICBjbG9uZSgpOiBOb2RlIHtcbiAgICByZXR1cm4gbmV3IE5vZGUodGhpcy5uYW1lLCB0aGlzLnBhdHRlcm4pXG4gIH1cblxuICBmaW5kKHBhcnQ6IHN0cmluZyk6ID9Ob2RlIHtcbiAgICBjb25zdCBub2RlID0gdGhpcy5jaGlsZHJlbi5nZXQocGFydClcbiAgICBpZiAobm9kZSkgcmV0dXJuIG5vZGVcblxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzLnBhdHRlcm5zLnZhbHVlcygpKSB7XG4gICAgICBpZiAobm9kZS5wYXR0ZXJuICYmIG5vZGUucGF0dGVybi50ZXN0KHBhcnQpKSByZXR1cm4gbm9kZVxuICAgIH1cbiAgfVxuXG4gIGluc2VydChub2RlOiBOb2RlKTogTm9kZSB7XG4gICAgY29uc3Qga2V5ID0gbm9kZS50b1N0cmluZygpXG4gICAgY29uc3QgY29sbGVjdGlvbiA9IG5vZGUucGF0dGVybiA/IHRoaXMucGF0dGVybnMgOiB0aGlzLmNoaWxkcmVuXG5cbiAgICBjb25zdCBvcmlnID0gY29sbGVjdGlvbi5nZXQoa2V5KVxuICAgIGlmIChvcmlnKSByZXR1cm4gb3JpZ1xuXG4gICAgY29sbGVjdGlvbi5zZXQoa2V5LCBub2RlKVxuICAgIHJldHVybiBub2RlXG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnBhdHRlcm4pIHtcbiAgICAgIHJldHVybiBgeyR7dGhpcy5uYW1lfX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWVcbiAgICB9XG4gIH1cbn1cbiJdfQ==